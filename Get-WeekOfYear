#https://stackoverflow.com/questions/23472027/how-is-first-day-of-week-determined-in-powershell/23475495#23475495
#https://stackoverflow.com/a/23475495
#Apparently powershell parameter -uformat %V doesn't actually use any kind of 'first day of week' rule. It actually just shows the amount of '7 days' that have passed since the beginning of the year (starting at 1).
#Using this information I made the following function that retrieves the same correct week number for each day in the week (sunday to saturday):
#(Thanks to both @DavidBrabant and @vonPryz for the additional info I required)
#This function basically gets the week number based on the nth Wednesday of the year and uses Sunday as the first day of the week (I haven't put time into changing that since this is actually the convention my company uses).
#You could say it retrieves the week number based on the first week having at least 4 days in this year, and the first day of the week being Sunday.
Function Get-WeekOfYear($date)
{
    # Note: first day of week is Sunday
    $intDayOfWeek = (get-date -date $date).DayOfWeek.value__
    $daysToWednesday = (3 - $intDayOfWeek)
    $wednesdayCurrentWeek = ((get-date -date $date)).AddDays($daysToWednesday)

    # %V basically gets the amount of '7 days' that have passed this year (starting at 1)
    $weekNumber = get-date -date $wednesdayCurrentWeek -uFormat %V

    return $weekNumber
}
#This code is from stackoverflow and in this repo as I could not find it on github
